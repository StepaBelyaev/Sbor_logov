# Практика 1
## Беляев Степан Константинович
## ББМО-02-23

2 ВМ c ОС Debian 12, server и client


## rsyslog


Проверяем работу установленного rsyslog
![](images/1.png)

Настраиваем на работу по udp по порту 514

![](images/4.png)

Прописываем правила

![](images/2.png)



### Настройка клиента

- Редактируем конфиг (/etc/rsyslog.d/all.conf - для всех логов)
  
![](images/5.png)

![](images/6.png)

### Логи на сервере

Смотрим директорию /var/log\
Директория client содержит логи с другой ВМ\
Проверяем  /var/log/client\

![](images/7.png)


## LOKI

Устанавливаем пакеты git и wget\
Устанавливаем go\


Добавляем путь в /etc/profile/

![](images/8.png)

Проверяем go

![](images/9.png)

 tcp и порт 3100

![](images/10.png)

Получаем loki, запускаем для проверки\
Проверяем в браузере метрики

![](images/12.png)

Cоздаём пользователя и прописываем права

![](images/13.png)

Создаём файл /etc/systemd/system/loki.service\
Заполняем необходимой инорфмацией

![](images/14.png)

Добавляем в автозапуск и включаем

![](images/15.png)

Проверяем 

![](images/16.png)


### Настройка promtail

Устанавливаем promtail, прописываем правила, запускаем

![](images/18.png)

![](images/19.png)

Проверяем 

![](images/20.png)

B браузере

![](images/21.png)

Настраиваем порт 9080 tcp,\
редактируем promtail.yaml

![](images/22.png)

Перезапускаем, открываем бразуер

![](images/23.png)

### Снова сервер

Скачиваем grafana\
Устанавливаем\

Настраиваем порт 3000

![](images/25.png)

Проверяем

![](images/26.png)

Открываем браузер

![](images/27.png)

Новый источник данных

![](images/28.png)

![](images/29.png)

Нажимаем сохранить

![](images/29.png)

Создаём новый DashBoard\
Выбираем добавленные данные\
выборка по filename и файл auth.log

![](images/32.png)

Нажимаем Run query, выбираем таблицу

![](images/33.png)

Получаем наш DashBoard на главной странице

![](images/34.png)


___
___
## elastic
___

___
## Выполнил Беляев Степан Константинович
## ББМО-02-23
___
___
___
